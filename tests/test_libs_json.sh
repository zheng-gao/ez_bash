###################################################################################################
# -------------------------------------- Import Libraries --------------------------------------- #
###################################################################################################
source "${EZ_BASH_HOME}/tests/utils.sh" || exit 1
source "${EZ_BASH_HOME}/src/libs/json.sh" || exit 1

###################################################################################################
# --------------------------------------- Test Function ----------------------------------------- #
###################################################################################################
TEST_FAILURE=0

function test_ez.json.flatten {
    local expects="$(
        echo -e "$(ez.text.format -f "Yellow")"\
".id  .name   .status  .version\n"\
"--   --      --       --$(ez.text.format -e "ResetAll")\n"\
"1    test 1           0.1.2\n"\
"2            false"
    )"
    local json_str='[{"id": 1, "name": "test 1", "version": "0.1.2"}, {"id": 2, "name": null, "status": false}]'
    local results="$(ez.json.flatten <<< "${json_str}")"
    ez.test.check --expects "expects" --results "results" || ((++TEST_FAILURE))
}

###################################################################################################
# ------------------------------------------ Run Test ------------------------------------------- #
###################################################################################################
test_ez.json.flatten

exit "${TEST_FAILURE}"
